/*
 * -------------------------------------------------
 *  ClinBioNGS Nextflow OPA-specific config file
 * -------------------------------------------------
 * Comment or remove the line of an option to use the default value
 */

params {

	// Required parameters
	seqPanel = 'OPA'

	// Initial parameters
	manifestDir = "${projectDir}/resources/manifests/OPA"
	libraryName = 'OPA_VariantLibrary'

	// Run parameters
	startingDataType             = 'BAM'
	seqPlatform                  = 'IonTorrent'
	amplicon                     = true
	singleEnd                    = true
	umiDna                       = true
	prepareIontorrentBam         = true
	prepareIontorrentSamplesheet = true

	// Manifest parameters
	prepareIontorrentManifest = true
	liftoverManifest          = true

	// Pipeline steps
	deduplicationRna = false
	tmb              = false
	msi              = false

	// BamQC analysis
	pctXCoverageDna = '10,50,100,200,500,1000,2000,3000,5000'
	lowCoverageDna  = '200'
	pctXCoverageRna = '10,50,100,200,500,1000,2000,3000,5000'
	lowCoverageRna  = '100'

	// SmallVariant analysis
	variantIntervalPadding = '0'
	variantMinCallers      = '3'
	variantHotspotBed      = "${params.smallVariantDir}/OPA_DNA_hg38.hotspots.bed"
	variantBlacklistBed    = "${params.smallVariantDir}/OCA_DNA_hg38.blacklist.bed"
	variantRecurrentFile   = "${params.smallVariantDir}/OPA_RecurrentMutations_20241201.txt"
	
	// CNA analysis
	cnvkitBaseline = "${projectDir}/resources/cna/OPA_reference_20240927.cnn"

	// Fusion analysis
	fusionFlagMinAD       = '10'
	fusionFlagMinNonFused = '0'
	fusionFlagMinDP       = '10'
	fusionFlagMinVAF      = '0.03'

	// Splicing analysis
	splicingFlagMinAD  = '100'
	splicingFlagMinDP  = '200'
	splicingFlagMinVAF = '0.03'

	// Plotting parameters
	bamqc_plotGlobalLabelAllGenesDna = 'true'
	bamqc_plotByGeneAllDna           = 'true'
	bamqc_plotGlobalLabelAllGenesRna = 'true'
	bamqc_plotByGeneAllRna           = 'true'
	cna_plotGlobalLabelAllGenes      = 'true'
	cna_plotByGeneAll                = 'true'

	// Report: DNA QC ranges
	qcRange_totalReadsDna         = '500000-700000'
	qcRange_alignedReadsPctDna    = '90-95'
	qcRange_ontargetReadsPctDna   = '70-90'
	qcRange_medianReadLengthDna   = '80-90'
	qcRange_medianCoverageDna     = '500-1000'
	qcRange_pct04xMeanCoverageDna = '80-90'
	qcRange_pct100xCoverageDna    = '95-98'

	// Report: RNA QC ranges
	qcRange_ontargetReadsRna    = '250000-500000'
	qcRange_alignedReadsPctRna  = '85-90'
	qcRange_medianReadLengthRna = '60-80'
	
	// Modules config
	ubamIonTorrent_publish  = true
	bamAddUmiQname          = true
	bamAddUmiQname_flagUmi1 = 'ZT'
	bamAddUmiQname_flagUmi2 = 'YT'
	bamAddUmiQname_umiDelim = '_'
	fastp_publish           = false

}

process {
	withName: TMAP { 
		ext.args = { [
			'--end-repair 15',
			'-J 20',
			'--max-one-large-indel-rescue 40',
		].join(' ') }
	}
}

